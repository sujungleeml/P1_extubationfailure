# 01_extract_db.ipynb 코드 설명

`01_extract_db.ipynb` 코드는 데이터베이스에서 테이블을 가져와, 성인 환자의 중환자실(ICU) 기록을 필터링하고, 삽관 및 발관 이벤트를 추출하는 과정을 다룹니다.

## 과정 요약

1. **데이터베이스 접근 및 테이블 추출**
   - 코드는 먼저 데이터베이스에 접근하여 필요한 테이블들을 가져옵니다. 이를 위해 데이터베이스 이름, 사용자 이름, 비밀번호 등의 정보가 필요합니다.

2. **성인 환자 필터링 및 ICU 기록 추출**
   - 가져온 데이터 중에서, 18세 이상의 성인 환자에 대한 기록을 필터링합니다. 이후 이들 환자의 중환자실(icu_stay) 체류 기록을 추출합니다.

3. **삽관 및 발관 이벤트 필터링**
   - 삽관(삽관) 및 발관(발관) 이벤트를 필터링하여 추출합니다. 이는 특정 아이템 ID를 기준으로 수행됩니다.

4. **중복 값 제거**
   - 추출된 데이터에서 중복된 값을 제거합니다. 여기서 중복값이란 삽관 (또는 발관) 이벤트의 발생 시각이 연속된 이벤트와 동일하거나, 1시간 이내에 발생한 경우를 의미합니다.  

5. **데이터 내보내기**
   - 최종적으로 정리된 데이터는 분석 및 추가 처리를 위해 내보내집니다. 이 데이터는 주로 삽관 및 발관 이벤트와 성인 중환자실 기록을 포함합니다.
    - 1. 성인 ICU 환자 데이터 ('adults_icu2.csv')
    - 2. 삽관/발관 이벤트 데이터 ('intubation_extubation.csv')
    - 3. (검증 데이터) 중복값 필터링 후 groupby 된 intubation 데이터 ('intubation_filtered_by_hadm_id_sorted.csv') 
    - 4. (검증 데이터) 중복값 필터링 후 groupby 된 extubation 데이터 ('extubation_filtered_by_hadm_id_sorted.csv') 

